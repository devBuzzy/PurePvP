<div id='topic' class='container <%= 'un' unless @topic.locked? %>locked'>
  <%= render :partial => 'forem/topics/head', :locals => { :topic => @topic } %>
  <div class='row'>
    <div class='col-md-2'>
      <%= render '/forem/forums/side' %>
    </div>
    <div class='col-md-10'>
      <div id='menu'>
        <div class="btn-group pull-right">
          <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-expanded="false">
            Actions <span class="caret"></span>
          </button>
          <ul class="dropdown-menu" role="menu">
            <% if @topic.can_be_replied_to? && can?(:reply, @topic) %>
            <li><%= link_to t(".reply"), forem.new_forum_topic_post_path(@forum, @topic)%></li>
            <% end %>
            <% if @topic.user == forem_user || forem_admin? %>
            <li><%= link_to t(".delete"), forem.forum_topic_path(@forum, @topic), :method => :delete, data: { :confirm => t("are_you_sure") } %></li>
            <% end %>
            <% if forem_user %>
            <% if !@topic.subscriber?(forem_user.id) %>
            <li><%= link_to t(".subscribe"), forem.subscribe_forum_topic_path(@forum, @topic), :method => :post %></li>
            <% else %>
            <li><%= link_to t(".unsubscribe"), forem.unsubscribe_forum_topic_path(@forum, @topic), :method => :post %></li>
            <% end %>
            <% end %>
          </ul>
        </div>
        <% if forem_admin? %>
        <div class="btn-group pull-right">
          <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-expanded="false">
            Moderation <span class="caret"></span>
          </button>
          <ul class="dropdown-menu" role="menu">
            <li><%= link_to t('forem.topic.links.edit'), forem.edit_admin_forum_topic_path(@forum, @topic)%></li>
            <li><%= link_to t(".hide.#{@topic.hidden}"), forem.toggle_hide_admin_forum_topic_path(@forum, @topic), :method => :put %></li>
            <li><%= link_to t(".lock.#{@topic.locked}"), forem.toggle_lock_admin_forum_topic_path(@forum, @topic), :method => :put %></li>
            <li><%= link_to t(".pin.#{@topic.pinned}"), forem.toggle_pin_admin_forum_topic_path(@forum, @topic), :method => :put %></li>
          </ul>
        </div>
        <% end %>
      </div>

      <% if @topic.pending_review? %>
      <div class="moderation alert" id='topic_moderation'>
        <%= t(".pending_review") %>
        <% if forem_admin_or_moderator?(@topic.forum) %>
        <%= form_for @topic, :url => forem.moderate_forum_topic_path(@topic.forum, @topic), :method => :put do |f| %>
        <%= render "/forem/moderation/options", :f => f %>
        <% end %>
        <% end %>
      </div>
      <% end %>

      <%= forem_pages_widget(@posts) %>

      <div id='posts'>
        <%= render :partial => "forem/posts/post", :collection => @posts %>
      </div>

      <%= forem_pages_widget(@posts) %>
    </div>
  </div>
</div>
